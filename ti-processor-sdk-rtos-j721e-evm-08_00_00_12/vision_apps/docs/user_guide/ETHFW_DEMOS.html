<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>Vision Apps User Guide: ETHFW Demos</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vision Apps User Guide
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ETHFW_DEMOS.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ETHFW Demos </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Ethernet firmware is integrated part of vision_apps and enabled by default. One can run all the OpenVx based demos alongside with Ethfw running on CPSW9G IP on J7ES EVM.</p>
<div class="image">
<img src="ethfw_demo_setup.jpg" alt="ethfw_demo_setup.jpg"/>
</div>
<h1><a class="anchor" id="autotoc_md237"></a>
Hardware Setup</h1>
<p>The below are required to run Ethfw</p><ul>
<li>J7ES EVM</li>
<li>GESI daughter card</li>
<li>Linux machine running DHCP server, this was tested on Ubuntu 18.04 but any version which supports hosting DHCP server would do</li>
<li>A client machine runnig Linux/Windows with a browser</li>
<li>A pair of network cables,<ul>
<li>One cable connected to port2 on the GESI card and other end connected to Linux machine</li>
<li>Second cable connected to port3 on the GESI card and other end connected to client machine</li>
</ul>
</li>
<li>eDP cable connected to a eDP capable display monitor for running OpenVx demos</li>
<li>UART cable connected to main UART port on the J7ES EVM</li>
<li>12V power supply for the EVM</li>
<li>SD card</li>
</ul>
<h1><a class="anchor" id="autotoc_md238"></a>
Software Setup</h1>
<ul>
<li>Install and run a DHCP server on Ubuntu 18.04 machine by following the instructions here <a href="https://help.ubuntu.com/community/isc-dhcp-server">https://help.ubuntu.com/community/isc-dhcp-server</a> This machine will provide IP to R5F (Main MCU2_0), A72 and any client connected via GESI card.</li>
<li>Install and run a Plex media server on the same Ubuntu 18.04 machine by following the instructions here <a href="https://www.plex.tv/en-gb/media-server-downloads/">https://www.plex.tv/en-gb/media-server-downloads/</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md239"></a>
Running the demo (Linux + RTOS) or (QNX + RTOS)</h1>
<ul>
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a></li>
<li>Open UART client like minicom on /dev/ttyUSB0 (instance 0) where Linux and OpenVx logs usually appear and another on /dev/ttyUSB2 for (instance 2) for NDK and Ethfw logs.</li>
<li>Power on the EVM and let the OS come up. If GESI board is connected then on /dev/ttyUSB2 you will see NDK registrationa and CPSW driver and Ethfw come up.</li>
<li>On successful boot, it will display R5F IP address and A72 IP address as below,</li>
</ul>
<div class="image">
<img src="mcu2_0_uart2_log.jpg" alt="mcu2_0_uart2_log.jpg"/>
</div>
<ul>
<li>Login and navigate to /opt/vision_apps on linux and /ti_fs/vision_apps on QNX, run the ./vision_apps_init.sh script.</li>
<li>Upon sucessfull completion you will notice the Ethfw log and version as below. You are now ready to run any of the OpenVx applications including DL applications using the SDK.</li>
</ul>
<div class="image">
<img src="linux_uart0_log.jpg" alt="linux_uart0_log.jpg"/>
</div>
<ul>
<li>To demostrate the switching capabily, on the server share a media file like a video file.</li>
<li>On the client machine open a brower and connect to the Plex server by typing the URL Eg. <code><a href="http://192.168.7.202:32400/web/index.html">http://192.168.7.202:32400/web/index.html</a></code></li>
<li>Once connection is established you can stream the video file via the J7ES CPSW9G running Ethfw in the background alongside other OpenVx demos.</li>
</ul>
<h2><a class="anchor" id="autotoc_md240"></a>
For QNX after running the vision_apps_init.sh script bring up the CPSW ethernet virtual driver as below,</h2>
<div class="fragment"><div class="line">slog2info -c</div><div class="line">slog2info -w</div><div class="line">&lt;Press Ctrl+C to come out&gt;</div><div class="line">on -C 0 io-pkt-v6-hc -d cpsw9g verbose=0x3ff</div><div class="line">dhclient -nw an0</div><div class="line">ifconfig</div></div><!-- fragment --><h1><a class="anchor" id="autotoc_md241"></a>
Known Issues</h1>
<ul>
<li>The GESI card uses the same connector pins as infotainment card so only one of them can be connected</li>
<li>The GESI card seems to conflict with QSGMII (CPSW2G) board on the J7ES EVM, this is a known issue. To workaround this issue manually unscrew and remove the QSGMII board from J7ES EVM</li>
<li>With Ethfw enabled by default, if infotainment board is connected it results in HDMI display corruption. eDP to HDMI adaptors also cannot be used with Ethfw enabled. To workaround this issue disable Ethfw if required or switch display to eDP.</li>
<li>As Ethfw uses NDK and it comes up during boot, it is possible that A72 acquired an IP even before R5. If this happens you will see an error message as below in the Linux UART. To workaround this issue bring down the eth and bring it back again as shown</li>
</ul>
<div class="fragment"><div class="line">ifconfig eth1 down</div><div class="line">ifconfig eth1 up</div></div><!-- fragment --><h1><a class="anchor" id="ETHFW_HOWTO_DISABLE"></a>
How to disable ETHFW</h1>
<ul>
<li>In file vision_apps_build_flags.mak, set BUILD_ENABLE_ETHFW?=no</li>
<li>Run "make vision_apps_scrub" prior to re-building</li>
<li>Note: Ethernet firmware must be disabled in order to use the HDMI display </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
